# Session Closeout Template with Issue Analysis

This template shows how to integrate issue tracking into session closeout summaries.

## Standard Session Summary Structure

Use this structure for all session SUMMARY.md or FINAL-SUMMARY.md files:

```markdown
# Session Summary: [Topic]

**Session ID**: session-YYYYMMDD-HHMMSS-topic
**Date**: YYYY-MM-DD
**Duration**: X hours
**Status**: [Investigation | In Progress | Complete | Deployed]

## Objective

[What was the goal of this session?]

## Work Completed

### Deliverables
- [x] Task 1
- [x] Task 2
- [ ] Task 3 (deferred)

### Artifacts Created
- `sessions/$SESSION_ID/artifacts/code/file.js` - Description
- `sessions/$SESSION_ID/artifacts/tests/file.test.js` - Description
- `sessions/$SESSION_ID/artifacts/docs/README.md` - Description

## ðŸ“Š Issue Tracking Analysis

> Auto-generated by: `bash sessions/issues/detect-issues.sh $SESSION_ID`

### New Issues Detected (X)

**ISSUE-###**: [High] [Title]
- **Description**: Brief description of new issue
- **Evidence**: Where it was found in this session
- **Next Steps**: What should be done

**ISSUE-###**: [Medium] [Title]
- **Description**: Brief description
- **Evidence**: Session artifacts showing issue
- **Next Steps**: Recommended action

### Updates to Existing Issues (X)

**ISSUE-003**: Session naming protocol violations
- **Update**: Additional evidence found (1 violation in related session)
- **Status**: Still open, needs automation
- **Evidence**: `sessions/current/` directory found

**ISSUE-008**: File routing compliance requires manual vigilance
- **Update**: 34 files found in root docs/ directory
- **Status**: Still open, validation needed
- **Evidence**: Detection script output

### Issues Resolved (X)

**ISSUE-004**: Documentation link breakage
- **Resolution**: Fixed remaining 28 broken links (100% success rate)
- **Verification**: All links validated via validate-links.py
- **Lessons Learned**: Pre-commit validation prevents recurrence

### Pattern Analysis

**Patterns Detected**:
- Recurring correction: Agent did X despite instructions (3rd occurrence)
- Documentation-code gap: Summary claimed deployment with no code changes
- Test failures: 2 tests failed in this session (unresolved)

**Pattern Storage**:
```bash
# Stored in memory for tracking
memory store --key "patterns/recurring-correction-X" \
  --value "{'occurrences': 3, 'sessions': [...]}" \
  --namespace "patterns"
```

**Threshold Watch**:
- Pattern "recurring-correction-X" at 3 occurrences (create issue at 3)
- Pattern "file-routing-violations" at 5 occurrences (monitor)

### Action Required

- [ ] Review [sessions/issues/ISSUE-###.md](sessions/issues/ISSUE-###.md) for new issue
- [ ] Update [sessions/issues/README.md](sessions/issues/README.md) index
- [ ] Address high-priority issues before next session
- [ ] Add patterns to captain's log for trend tracking

## Deployment Status

### Code Changes
- [x] Files modified: [list actual files changed]
- [x] Git commits: [commit hashes]
- [x] Tests passing: [test results]
- [x] Feature demonstrable: [verification method]

### Verification Checklist
- [x] `git diff` shows file changes at documented paths
- [x] Code files exist and contain expected functionality
- [x] Tests written and passing
- [x] Documentation updated
- [ ] No session-specific code in root directories

## Next Steps

1. [Next action item]
2. [Next action item]
3. Address issues: ISSUE-### (priority)

## Captain's Log Entry

**Added to**: `sessions/captains-log/YYYY-MM-DD.md`

```markdown
### Session: [Topic] (session-YYYYMMDD-HHMMSS-topic)

**Outcome**: [Brief outcome]
**Issues**: Detected X new, updated Y existing, resolved Z
**Key Learning**: [Main lesson from this session]
```

## Memory Updates

**Stored for future sessions**:
- Key: `sessions/$SESSION_ID/summary`
- Key: `issues/ISSUE-###` (new issues)
- Key: `patterns/...` (detected patterns)

---

**Issue Analysis Generated**: YYYY-MM-DD HH:MM:SS
**Detection Script**: `sessions/issues/detect-issues.sh`
**Issue Registry**: [sessions/issues/README.md](sessions/issues/README.md)
```

---

## Usage Instructions

### 1. During Session Closeout

Run the detection script:
```bash
SESSION_ID="session-$(date +%Y%m%d-%H%M%S)-topic"
bash sessions/issues/detect-issues.sh $SESSION_ID
```

### 2. Copy Output to Summary

The script will output a formatted issue analysis. Copy this into your session SUMMARY.md under the "ðŸ“Š Issue Tracking Analysis" section.

### 3. Review and Enhance

The automated detection provides a baseline. Enhance with:
- Context from the session conversation
- Specific evidence (file paths, line numbers)
- User-reported issues not caught by automation
- Lessons learned and recommendations

### 4. Update Issue Files

For each new issue or update:
```bash
# Create new issue
bash sessions/issues/issue-utils.sh create "Issue title" high bug system

# Update existing issue
# Edit the issue file directly, adding Evidence section entry:
# - Session: session-YYYYMMDD-HHMMSS-topic
# - Evidence: [what was found]
# - Updated: YYYY-MM-DD
```

### 5. Update Index

Regenerate statistics:
```bash
bash sessions/issues/issue-utils.sh update-index
```

---

## Example: Complete Session with Issue Analysis

See below for a real example of a session closeout with full issue integration:

```markdown
# Session Summary: Implement User Authentication

**Session ID**: session-20251121-143000-user-auth
**Date**: 2025-11-21
**Duration**: 2.5 hours
**Status**: Complete

## Objective

Implement JWT-based authentication system with login, registration, and session management.

## Work Completed

### Deliverables
- [x] User model and database schema
- [x] Registration endpoint with validation
- [x] Login endpoint with JWT generation
- [x] Authentication middleware
- [x] Comprehensive tests (15/15 passing)

### Artifacts Created
- `sessions/session-20251121-143000-user-auth/artifacts/code/models/User.js`
- `sessions/session-20251121-143000-user-auth/artifacts/code/routes/auth.js`
- `sessions/session-20251121-143000-user-auth/artifacts/code/middleware/auth.js`
- `sessions/session-20251121-143000-user-auth/artifacts/tests/auth.test.js`
- `sessions/session-20251121-143000-user-auth/artifacts/docs/AUTH-API.md`

## ðŸ“Š Issue Tracking Analysis

### New Issues Detected (0)

No new issues detected in this session.

### Updates to Existing Issues (1)

**ISSUE-002**: Documentation-code synchronization confusion
- **Update**: This session properly verified deployment before claiming complete
- **Evidence**: Git commits + test pass + feature demonstrable
- **Status**: Good example of proper verification workflow

### Issues Resolved (0)

No issues resolved in this session.

### Pattern Analysis

**Patterns Detected**:
- âœ… All tests passing (15/15)
- âœ… Code in proper session directories
- âœ… Documentation updated with code
- âœ… Git commits match deliverables

**No Negative Patterns**: Session followed all protocols correctly.

### Action Required

- [x] No action required - clean session!
- [x] Consider documenting this as example workflow

## Deployment Status

### Code Changes
- [x] Files modified: 4 new files in session artifacts
- [x] Git commits: abc123def (if integrated to main)
- [x] Tests passing: 15/15 (100%)
- [x] Feature demonstrable: Login/registration working via Postman

### Verification Checklist
- [x] `git diff` shows expected changes
- [x] All code in session artifacts (not root)
- [x] Tests comprehensive (auth flows, edge cases, security)
- [x] Documentation includes API examples
- [x] No secrets hardcoded

## Next Steps

1. Code review before merging to main
2. Add rate limiting to prevent brute force
3. Implement password reset functionality
4. Add OAuth providers (Google, GitHub)

## Captain's Log Entry

Added to: `sessions/captains-log/2025-11-21.md`

### Session: User Authentication (session-20251121-143000-user-auth)

**Outcome**: âœ… Complete - JWT authentication system implemented
**Issues**: No new issues, clean session following all protocols
**Key Learning**: This session demonstrates ideal workflow - verification at every step, proper file routing, comprehensive testing
```

---

## Integration with Captain's Log

When creating captain's log entries, reference issues:

```markdown
### Session: [Topic] (session-ID)

**Outcome**: [outcome]
**Issues Detected**:
- New: ISSUE-011 (Database connection timeout)
- Updated: ISSUE-003 (Additional session naming violation)
- Resolved: ISSUE-004 (Documentation links fixed)

**Pattern Analysis**:
- Recurring: File routing violations (5th occurrence)
- New: Test failures in integration tests

**Action Items**:
- [ ] Address ISSUE-011 (critical priority)
- [ ] Review file routing automation (ISSUE-008)
```

---

## Automation Roadmap

### Phase 1: Manual (Current)
- Run detection script manually during closeout
- Copy/paste results into summary
- Update issue files manually

### Phase 2: Semi-Automated
- Pre-closeout hook runs detection automatically
- Results appended to summary template
- Issue files updated automatically

### Phase 3: Fully Automated
- Real-time issue detection during session
- Continuous pattern tracking
- Auto-suggest issue creation when threshold reached
- One-click closeout with full analysis

---

**Last Updated**: 2025-11-21
**Template Version**: 1.0.0
